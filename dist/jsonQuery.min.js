/*! jsonQuery 20-05-2014 */
"use strict";!function(a,b){"object"==typeof module&&module.exports&&(module.exports=b(a)),"function"==typeof define&&define.amd&&define(function(){return b(a)}),a.jsonQuery=b(a)}(this,function(){var a=function(a){this.data=a||{},this.properties=null,this.root=a||{}},b=function(a,b){1===arguments.length&&(b=a,a=""),Error.call(this,b),this.name="ShowError",this.operation=a};return b.prototype=new Error,b.prototype.constructor=b,a.prototype={from:function(a){var b,c,d=[];for(this.properties=a.split("."),this.index=-1,this.lastIndex=this.properties.length-1;++this.index<=this.lastIndex;)if(this.is(this.data,"array")){for(c=this.data.length,b=0;c>b;b+=1)this.data[b].hasOwnProperty(this.properties[this.index])?(this.data[b]=this.data[b][this.properties[this.index]],d.push(this.data[b])):this.data=null;this.data=d}else this.data=this.data.hasOwnProperty(this.properties[this.index])?this.data[this.properties[this.index]]:null;return this},remove:function(a){var b,c;if(a)if(this.is(this.data,"array"))for(c=this.data.length,b=0;c>b;b+=1)this.data[b].hasOwnProperty(a)&&delete this.data[b][a];else this.data.hasOwnProperty(a)&&delete this.data[a];return this},insert:function(a){var b,c,d;if(a)for(b in a)if(a.hasOwnProperty(b))if(this.is(this.data,"array"))for(d=this.data.length,c=0;d>c;c+=1)this.data[c].hasOwnProperty(b)||(this.data[c][b]=a[b]);else this.data.hasOwnProperty(b)||(this.data[b]=a[b]);return this},where:function(a){var b,c,d,e,f,g,h=[],i=[],j=Object.keys(a).length,k={or:/(||)/,and:/(&&)/,not:/(not:)/},l=function(a,b){var c,d,e;for(c in b)b.hasOwnProperty(c)&&(d=a.search(b[c]),e=d>-1?c:"even");return e};if(a&&this.is(this.data,"array")&&this.is(a,"object"))for(g=this.data.length,f=0;g>f;f+=1){h.length=0;for(b in a)if(a.hasOwnProperty(b))switch(c=l(a[b],k)){case"and":d=a[b].split(" && ")[0],e=a[b].split(" && ")[1],a[f][b]===d&&a[f][b]===e&&h.push("found");break;case"or":d=a[b].split(" || ")[0],e=a[b].split(" || ")[1],(a[f][b]===d||a[f][b]===e)&&h.push("found");break;case"not":this.data[f][b]!==a[b]&&h.push("found");break;case"even":this.data[f][b]===a[b]&&h.push("found")}h.length===j&&i.push(this.data[f])}return this.data=i,this},set:function(a){var b,c,d;if(a)for(b in a)if(a.hasOwnProperty(b))if(this.is(this.data,"array"))for(d=this.data.length,c=0;d>c;c+=1)this.data[c].hasOwnProperty(b)&&(this.data[c][b]=a[b]);else this.data.hasOwnProperty(b)&&(this.data[b]=a[b]);return this},sort:function(a,b,c){return 3===arguments.length&&this.is(this.data,"array")&&this.data.sort(function(){var d;return d="asc"===c?function(c,d){var e;return e="string"===b?c[a].toLowerCase()<d[a].toLowerCase()?-1:c[a].toLowerCase()>d[a].toLowerCase()?1:0:c[a]<d[a]?-1:c[a]>d[a]?1:0}:function(c,d){var e;return e="string"===b?d[a].toLowerCase()<c[a].toLowerCase()?-1:d[a].toLowerCase()>c[a].toLowerCase()?1:0:d[a]<c[a]?-1:d[a]>c[a]?1:0}}),this},select:function(a,b){var c,d,e,f=a?this.root:this.data;if(b)if(this.is(f,"array"))for(e=f.length,c=[],d=0;e>d;d+=1)f[d].hasOwnProperty(b)?c.push(f[d][b]):c=null;else c=f.hasOwnProperty(b)?f[b]:null;else c=f;return c},is:function(a,b){return Object.prototype.toString.call(a)==="[object "+(b.charAt(0).toUpperCase()+b.slice(1))+"]"},extend:function(a,b){var c;if(b&&this.is(this.data,"object"))for(c in b)b.hasOwnProperty(c)&&(a[c]=b[c]);return a},clone:function(){return this.is(this.data,"object")?this.data=this.extend({},this.data):this.is(this.data,"array")&&(this.data=this.data.slice(0)),this},resolve:function(a){for(var b=a.split("."),c=this.data,d=-1,e=b.length-1;++d<=e;){if(!c.hasOwnProperty(b[d]))return!1;c=c[b[d]]}return!0},plant:function(a,b){function c(){return i>h}function d(){return h===i-1}if(a)for(var e,f=this.data,g=a.split("."),h=0,i=g.length;c();)e=g[h],f.hasOwnProperty(e)||(f[e]={}),d()&&(f[e]=b),f=f[e],h+=1}},function(b){return new a(b)}});